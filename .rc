#################################\
# | |__   __ _ _ __ _ __ _   _    \
# | '_ \ / _` | '__| '__| | | |    \
# | | | | (_| | |  | |  | |_| |     \
# |_| |_|\__,_|_|  |_|   \__, |      \
#                        |___/        \
#######################################\
# github: https://github.com/harrybrwn
# website: http://harrybrwn.com

# If not running interactively, don't do anything
[[ $- != *i* ]] && return

export EDITOR=vim
export VISUAL=vim

# Enable colors for less and man pages
export LESS="--RAW-CONTROL-CHARS"

export GO_VERSION="go1.14.1"
export GOPATH="$HOME/dev/go"
[ -f "$HOME/.local/profile.d/paths.sh" ] && . "$HOME/.local/profile.d/paths.sh"
[ -f "$HOME/.local/profile.d/vars.sh" ] && . "$HOME/.local/profile.d/vars.sh"
#if [ -d "$HOME/.local/bin" ]; then
#PATH="$HOME/.local/bin:$PATH"
#fi

# stty -ixon # disable ctrl-s

if command -v exa > /dev/null 2>&1; then
    alias ls='exa --group-directories-first'
    alias l='ls -la --git'
    alias la='ls -a'
else
    alias ls='ls -hN --color=auto --group-directories-first'
    alias l="ls -lAh"
    alias la="ls -A"
fi

alias g=git
alias rr='curl -s -L https://raw.githubusercontent.com/keroserene/rickrollrc/master/roll.sh | bash'
alias fsizes='du -sh $(/bin/ls -A) | sort -hr'
alias grep='grep --color=auto --exclude-dir={.bzr,CVS,.git,.hg,.svn} --directories=skip'
# alias gohtml='echo "" > gocoverage.txt && go test ./... -v -cover -race -coverprofile=gocoverage.txt -covermode=atomic && go tool cover -html=gocoverage.txt && rm gocoverage.txt'
alias gohtml='echo "" > gocoverage.txt && go test ./... -v -cover -coverprofile=gocoverage.txt -covermode=atomic && go tool cover -html=gocoverage.txt && rm gocoverage.txt'

alias ap=apizza apizza-docker='docker run --rm -it apizza:latest'
alias pass=gopass pas=gopass
alias wifi=wavemon
alias howto=how2
alias say=espeak

# alias wifi="nmcli --colors yes device wifi list"
alias settings=gnome-control-center
alias paths='sed "s/:/\n/g" <<< "$PATH"'
alias copy="xclip -i" paste="xclip -o"
alias aspdf='libreoffice --headless --invisible --convert-to pdf'
alias htmltopdf='wkhtmltopdf'
alias githistory='gource -a 1 -c 4.0 -f .'
alias wget='wget --hsts-file ~/.config/wget/wget-hsts'
alias screenrec='sh ~/tools/screencast.sh'

if [ -d ~/.config/google-chrome/Default/Extensions/hmjkmjkepdijhoojdojkdfohbdgmmhki ]; then
    alias notes='/opt/google/chrome/google-chrome --profile-directory=Default --app-id=hmjkmjkepdijhoojdojkdfohbdgmmhki'
elif [ -d ~/.local/share/applications ]; then
    desktop_file=`grep -l 'Keep' ~/.local/share/applications/* 2>&1 /dev/null`
    alias notes="bash <(grep -Po '(?<=Exec=).*' $desktop_file)"
    unset desktop_file
else
    alias notes='echo "google keep not installed"'
fi

mkdircd() {
    mkdir $1 && cd $1
}

net() {
    # lspci -vv -s $(lspci | grep -i wireless | awk '{print $1}')
    # iwconfig $(iw dev | awk '/Interface /{print $2}')
    watch -n1 --color nmcli --colors yes device wifi list
}

# Because i'm scared
rm() {
    for f in "$*"; do
        if
            [ $f = $HOME ] ||
            [ $f = '~' ] ||
            [ "$f" = "/" ] ||
            [ "$f" = "/home" ] ||
            [ "$f" = "/home/" ] ||
            [ "$f" = "$HOME/dev" ]
        then
            echo 'do not remove the home directory!!'
            return 1
        fi
    done
    /bin/rm $*
}

open() {
    if [[ $1 == *.md ]]; then
        x-www-browser $*  # I have a browser extention that renders markdown
    else
        xdg-open $*
    fi
}

google() {
	local q="$*"

	if [ -z "$q" ]; then
		x-www-browser "https://www.google.com"
	else
        local query=""
        for w in $(echo "$q"); do
            if [ -n "$query" ]; then
                query="$query+$w"
            else
                query="$w"
            fi
        done
		x-www-browser "https://www.google.com/search?q=$query"
	fi
}

lines() {
	find . -name "$1" | xargs wc -l | sort -k 1n
    # (find . -name "$1" -print '%p ' | xargs -0 cat) | wc -l
}

whi() {
    readlink -f $(which $1)
}

show-colors() {
    for i in {0..255} ; do
        printf "\x1b[38;5;${i}mcolour${i} "
    done
    echo ''
}

reset-mouse-speed() {
    xinput set-prop 'MX Master 2S Mouse' 'libinput Accel Speed' 1.0 > /dev/null 2>&1
    xinput set-prop 'MX Master 2S Mouse' 'Coordinate Transformation Matrix' \
        1.0 0.0 0.0 \
        0.0 1.0 0.0 \
        0.0 0.0 1.0 > /dev/null 2>&1
    xinput set-prop 'SYNA2B31:00 06CB:7F8B Touchpad' 'libinput Accel Speed' 1.0
    xinput set-prop 'SYNA2B31:00 06CB:7F8B Touchpad' 'Coordinate Transformation Matrix' \
        1.0 0.0 0.0 \
        0.0 1.0 0.0 \
        0.0 0.0 1.0
}

if command -v tmux > /dev/null && [ -z "$TMUX" ]; then
    [ `hostname` != 'harry-yoga920' ] && return # only run tmux on my machine
    alias ta='tmux attach && unalias ta'
    if tmux ls > /dev/null 2>&1; then
        if [ $(tmux display -p '#{session_attached}') -eq 0 ]; then
            # Uncomment to automatically attatch tmux if session exists
            #tmux attach -t $(tmux ls -F '#{session_name}' | head -n 1)
            :
        fi
    else
        tmux new -d -s misc -c ~/
    fi
fi

if ! echo $PATH | tr ':' '\n' | grep "$HOME/.local/bin" > /dev/null; then
    # echo 'no .local/bin in path'
    PATH="$HOME/.local/bin:$PATH"
fi

# [[ -s "$HOME/.config/gvm/scripts/gvm" ]] && source "$HOME/.config/gvm/scripts/gvm"
[[ -f "$HOME/school/tanya/get-alias.sh" ]] && source "$HOME/school/tanya/get-alias.sh"

if command -v xinput > /dev/null 2>&1; then
    xinput set-prop 'MX Master 2S Mouse' 'libinput Accel Speed' 1.0 > /dev/null 2>&1
    xinput set-prop 'MX Master 2S Mouse' 'Coordinate Transformation Matrix' \
        1.1 0.0 0.0 \
        0.0 1.1 0.0 \
        0.0 0.0 0.8 > /dev/null 2>&1
    xinput set-prop 'SYNA2B31:00 06CB:7F8B Touchpad' 'libinput Accel Speed' 1.0
    xinput set-prop 'SYNA2B31:00 06CB:7F8B Touchpad' 147 \
        1.0 0.0 0.0 \
        0.0 1.0 0.0 \
        0.0 0.0 1.0
fi
