- name: Check if tree-sitter-cli is installed
  stat:
    path: '{{ ansible_facts.user_dir }}/.config/cargo/bin/tree-sitter'
  register: tree_sitter_bin

- name: Install
  when: not tree_sitter_bin.stat.exists
  block:
    - name: Dependancies
      become: true
      ansible.builtin.package:
        name:
          - libclang-dev
    - name: Compile
      ansible.builtin.command:
        cmd: cargo install tree-sitter-cli
        creates: '{{ ansible_facts.user_dir }}/.config/cargo/bin/tree-sitter'
